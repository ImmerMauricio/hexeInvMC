---
output: github_document
---

# hexeInvMC

**RegresiÃ³n inversa con incertidumbre en ambos ejes, basada en simulaciÃ³n Monte Carlo extendida**  
Desarrollado por Immer Mauricio Caicedo GonzÃ¡lez  
Inspirado en la metrologÃ­a, la intuiciÃ³n cientÃ­ficaâ€¦ y la libertad de las brujitas.

---

## ğŸ” Â¿QuÃ© hace este paquete?

Permite estimar un valor de `x` (por ejemplo, concentraciÃ³n) a partir de un `y` observado (respuesta instrumental), incorporando:

- Incertidumbre en ambos ejes (`ux`, `uy`)
- SelecciÃ³n automÃ¡tica del mejor modelo (lineal o cuadrÃ¡tico)
- DiagnÃ³stico metrolÃ³gico realista (outliers, RÂ², heterocedasticidad)
- EstimaciÃ³n por Monte Carlo extendido (10 000 simulaciones por defecto)
- VisualizaciÃ³n clara con errores bidimensionales y punto estimado destacado

---

## ğŸš€ InstalaciÃ³n

```r
install.packages("devtools") # si no lo tienes
devtools::install_github("ImmerMauricio/hexeInvMC")
library(hexeInvMC)
```

---

## ğŸ§ª Ejemplo de uso

```r
x <- c(1.2, 1.9, 2.9, 4.0, 4.7, 5.9)
ux <- c(0.2, 0.2, 0.2, 0.2, 0.2, 0.2)
y <- c(3.4, 4.4, 7.2, 8.5, 10.8, 13.5)
uy <- c(0.2, 0.2, 0.2, 0.4, 0.4, 0.4)

hexeInvMC(x, ux, y, uy, y0 = 10.5, uy0 = 0.25)
```

---

## ğŸ“Š Â¿CÃ³mo se simulan las incertidumbres?

Puedes especificar la distribuciÃ³n que representa mejor tus incertidumbres:

| Argumento   | Opciones        | CuÃ¡ndo usarlo                              |
|-------------|-----------------|--------------------------------------------|
| `dist_x`    | `"norm"`        | Errores tipo A bien caracterizados         |
|             | `"unif"`        | Incertidumbre tipo B, sin preferencia      |
|             | `"triangle"`    | Valor mÃ¡s probable con lÃ­mites conocidos   |
| `dist_y`    | Igual que arriba| Para `y` (respuesta instrumental)          |
| `dist_y0`   | Igual que arriba| Para el valor observado a estimar          |

> Por defecto se usa `"norm"` para todo.  
> Esto se puede cambiar fÃ¡cilmente en los argumentos.

---

## ğŸ§¾ Resultado e interpretaciÃ³n

La funciÃ³n imprime un resumen claro:

- âœ… Modelo seleccionado (`lineal_simple` o `pol_cuadratico`)
- âœ… Valor de `x` estimado
- âœ… Incertidumbre tÃ­pica combinada `uc(x)`
- âœ… DiagnÃ³stico estadÃ­stico:
  - Outliers
  - RÂ² bajo
  - Heterocedasticidad
- âœ… GrÃ¡fico `ggplot2`:
  - LÃ­nea de calibraciÃ³n
  - Barras de error horizontales y verticales
  - Punto rojo del valor estimado

---

## ğŸ“š Fundamentos

Este paquete se inspira en:

- ğŸ“˜ ISO 8466-1 (1999): calibraciÃ³n lineal con incertidumbre en `y`
- ğŸ“˜ ISO/TS 28037 (2010): regresiÃ³n con incertidumbre en ambos ejes
- ğŸ“˜ GUM (JCGM 100:2008): GuÃ­a para la expresiÃ³n de la incertidumbre

Pero supera sus limitaciones al:

- âœ… Permitir regresiÃ³n cuadrÃ¡tica con incertidumbre en `x`
- âœ… Evitar el uso obligatorio de validaciones `chiÂ²` que no aplican
- âœ… Trabajar con simulaciÃ³n Monte Carlo extendida
- âœ… Adaptarse a datos experimentales reales

---

## â¤ï¸ Autor

Immer Mauricio Caicedo GonzÃ¡lez  
ğŸ“§ quimiometria@live.com  
ğŸ“ BogotÃ¡, Colombia  
ğŸ§ª MetrologÃ­a, QuimiometrÃ­a y Ciencia con alma

---

> hexeInvMC no es solo un algoritmo.  
> Es un acto de claridad cientÃ­ficaâ€¦ con respeto por el laboratorio real.  
> Y con un guiÃ±o invisible a quien alguna vez nos enseÃ±Ã³ a intuir.

ğŸ§šğŸª„ï¸âœ¨
